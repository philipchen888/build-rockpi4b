Compile mainline kernel:

wget https://git.kernel.org/torvalds/t/linux-6.18-rc4.tar.gz
tar -xzf linux-6.18-rc4.tar.gz
mv linux-6.18-rc4 linux
vi ./linux/arch/arm64/configs/defconfig ( enable NVMe change to:
CONFIG_PHY_ROCKCHIP_PCIE=y
CONFIG_BLK_DEV_NVME=y
CONFIG_PCIE_ROCKCHIP_HOST=y
CONFIG_SATA_AHCI=y
CONFIG_EXT4_FS=y
CONFIG_PCIEPORTBUS=y
CONFIG_VIDEO_ROCKCHIP_VDEC=y
CONFIG_VIDEO_ROCKCHIP_RGA=y
CONFIG_MEDIA_SUPPORT=y
CONFIG_MEDIA_CONTROLLER=y
CONFIG_VIDEO_DEV=y
CONFIG_V4L2_MEM2MEM_DEV=y
CONFIG_V4L2_H264=y
CONFIG_VIDEO_HANTRO=m
CONFIG_VIDEO_HANTRO_ROCKCHIP=y
CONFIG_SPI_SPIDEV=y
)

vi ./linux/arch/arm64/boot/dts/rockchip/rk3399-rock-pi-4.dtsi ( add
&i2c7 {
        i2c-scl-rising-time-ns = <450>;
        i2c-scl-falling-time-ns = <15>;
        status = "okay";
};

&uart4 {
        status = "okay";
};

&spi2 {
        status = "okay";
        spidev@0 {
                compatible ="cisco,spi-petra";
                reg = <0>;
                spi-max-frequency = <50000000>;
        };
};

&pwm1 {
        status = "okay";
};
)

make kernel
